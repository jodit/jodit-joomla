"use strict";!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o=t();for(var n in o)("object"==typeof exports?exports:e)[n]=o[n]}}(self,(function(){return(self.webpackChunkjodit_pro=self.webpackChunkjodit_pro||[]).push([[633],{691:function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.autocomplete=void 0;var n=o(1),r=o(325),i=o(120),s=o(155),u=o(131),l=o(122),c=o(692),a=o(121),p=o(2),d=o(695);i.Config.prototype.autocomplete={sources:[],maxItems:50,isMatchedQuery:function(e,t){return 0===t.toLowerCase().indexOf(e.toLowerCase())},itemRenderer:function(e){var t;return null!==(t=e.title)&&void 0!==t?t:e.value},insertValueRenderer:function(e){return e.value+"&nbsp;"}};var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.requires=["enter","license"],t.hasStyle=!p.Jodit.fatMode,t.sources=[],t}return(0,n.__extends)(t,e),t.prototype.afterInit=function(e){var t=this;this.popup=new l.Popup(e),this.popup.setMod("padding",!1),this.list=new c.Autocomplete(e),this.popup.setContent(this.list.container),e.e.on("select.autocomplete",(function(o){var n=o.value;(0,u.isFunction)(o.insertValueRenderer)&&(n=o.insertValueRenderer(o)),l.Dom.isNode(n)||(n=e.createInside.fromHTML(n)),(0,d.replaceTextLeftOfCursorAfterSpace)(e.s.range,n),t.j.s.setCursorAfter(n),t.popup.close()})).on("keydown.autocomplete",this.onKeyDown).on("keydown.autocomplete",this.onKeyControlDown,void 0,!0).on("beforeEnter.autocomplete",this.onEnter,void 0,!0).on("autocomplete.autocomplete",this.onAutoComplete).on("registerAutocompleteSource.autocomplete",this.registerAutocompleteSource)},t.prototype.registerAutocompleteSource=function(e){this.sources.push(e)},t.isControlKey=function(e){return e===a.KEY_DOWN||e===a.KEY_UP||e===a.KEY_ENTER||e===a.KEY_TAB},t.prototype.onKeyDown=function(e){var o;return(0,n.__awaiter)(this,void 0,Promise,(function(){var r,i,s;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return e.key===a.KEY_ESC?(this.popup.isOpened&&this.popup.close(),[2]):t.isControlKey(e.key)||!this.j.s.isCollapsed?[2]:(r=null===(o=this.j.s.sel)||void 0===o?void 0:o.getRangeAt(0))&&l.Dom.isOrContains(this.j.editor,r.startContainer)?(i=(0,d.getTextLeftOfCursor)(r).split(" ").pop())&&(0,u.trim)(i).length?[4,this.onAutoComplete(i)]:[3,2]:[2];case 1:if((s=n.sent()).length)return[2,this.openPopup(s)];n.label=2;case 2:return this.popup.isOpened&&this.popup.close(),[2]}}))}))},t.prototype.onKeyControlDown=function(e){if(this.popup.isOpened&&t.isControlKey(e.key)){switch(e.key){case a.KEY_DOWN:this.list.selectNext();break;case a.KEY_UP:this.list.selectPrevious();break;case a.KEY_TAB:this.list.select()}return this.j.e.stopPropagation(e.type),!1}},t.prototype.onEnter=function(){if(this.popup.isOpened)return this.list.select(),!1},t.prototype.onAutoComplete=function(e){return(0,n.__awaiter)(this,void 0,Promise,(function(){var t,o=this;return(0,n.__generator)(this,(function(r){switch(r.label){case 0:return t=[],[4,Promise.all(this.sources.concat(this.j.o.autocomplete.sources).map((function(r){return(0,n.__awaiter)(o,void 0,void 0,(function(){var o,i,s,u;return(0,n.__generator)(this,(function(l){switch(l.label){case 0:return i=(o=t.push).apply,s=[t],u=[[]],[4,this.resolveFeed(e,r)];case 1:return i.apply(o,s.concat([n.__spreadArray.apply(void 0,u.concat([n.__read.apply(void 0,[l.sent()]),!1]))])),[2]}}))}))})))];case 1:return r.sent(),[2,t]}}))}))},t.prototype.resolveFeed=function(e,t,o){return(0,n.__awaiter)(this,void 0,Promise,(function(){var r,i,s,l,c,a;return(0,n.__generator)(this,(function(p){switch(p.label){case 0:return(0,u.isPromise)(t)?[4,t]:[3,2];case 1:t=p.sent(),p.label=2;case 2:return(0,u.isFunction)(t)?[4,t(e)]:[3,4];case 3:return r=p.sent(),[3,7];case 4:return(0,u.isArray)(t)?(i=this.j.o.autocomplete.isMatchedQuery,r=t.filter((function(t){return(0,u.isString)(t)?i(e,t):i(e,t.value)})).map((function(e){return(0,u.isString)(e)?{title:e,value:e}:e})),[3,7]):[3,5];case 5:return[4,this.resolveFeed(e,t.feed,t)];case 6:r=p.sent(),p.label=7;case 7:return r&&(0,u.isArray)(r)?(l=(s=this.j.o.autocomplete).itemRenderer,c=s.insertValueRenderer,a=s.maxItems,r=r.map((function(e){var t,r;return(0,n.__assign)({itemRenderer:null!==(t=null==o?void 0:o.itemRenderer)&&void 0!==t?t:l,insertValueRenderer:null!==(r=null==o?void 0:o.insertValueRenderer)&&void 0!==r?r:c},e)})),[2,r.slice(0,a)]):[2,[]]}}))}))},t.prototype.openPopup=function(e){var t=this;this.list.build(e),this.popup.open((function(){return t.j.s.range.getBoundingClientRect()}))},t.prototype.beforeDestruct=function(e){e.e.off(this.list).off("keydown.autocomplete",this.onKeyDown).off("autocomplete.autocomplete",this.onAutoComplete).off(".autocomplete"),this.list.destruct(),this.popup.destruct()},(0,n.__decorate)([s.autobind],t.prototype,"registerAutocompleteSource",null),(0,n.__decorate)([(0,s.debounce)()],t.prototype,"onKeyDown",null),(0,n.__decorate)([s.autobind],t.prototype,"onKeyControlDown",null),(0,n.__decorate)([s.autobind],t.prototype,"onEnter",null),(0,n.__decorate)([s.autobind],t.prototype,"onAutoComplete",null),(0,n.__decorate)([s.autobind],t.prototype,"resolveFeed",null),t}(r.Plugin);t.autocomplete=f,p.Jodit.plugins.add("autocomplete",f)},695:function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.replaceTextLeftOfCursorAfterSpace=t.getTextLeftOfCursor=void 0;var n=o(145),r=o(399);t.getTextLeftOfCursor=function(e){var t,o,i,s,u=e.startContainer,l=e.startOffset;if(n.Dom.isText(u))return null!==(o=null===(t=u.nodeValue)||void 0===t?void 0:t.substr(0,l))&&void 0!==o?o:"";var c=u.childNodes[l];if(!c)return"";if(n.Dom.isText(c))return null!==(i=c.nodeValue)&&void 0!==i?i:"";var a=(0,r.findNotEmptyNeighbor)(c,!0,u);return n.Dom.isText(a)&&null!==(s=c.nodeValue)&&void 0!==s?s:""},t.replaceTextLeftOfCursorAfterSpace=function(e,t){var o,r=e.startContainer,i=e.startOffset;if(n.Dom.isText(r)){var s=null!==(o=r.nodeValue)&&void 0!==o?o:"",u=s.substr(0,i),l=s.substr(i),c=u.split(" ");c[c.length-1]="";var a=c.join(" ");return r.nodeValue=a+l,e.setStart(r,a.length),void e.insertNode(t)}}},692:function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.Autocomplete=void 0;var n=o(1);o(693);var r=o(155),i=o(236),s=o(694),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elements=[],t.currentSelection=-1,t}return(0,n.__extends)(t,e),t.prototype.className=function(){return"Autocomplete"},t.prototype.onChangeSelection=function(e,t){var o;null!=t&&(null===(o=this.elements[t])||void 0===o||o.setMod("active",!1)),this.elements[this.currentSelection].setMod("active",!0),this.elements[this.currentSelection].container.scrollIntoView(!1)},t.prototype.build=function(e){var t=this;this.clear(),e.forEach((function(e,o){var n=new s.AutocompleteItem(t.jodit,e);t.j.e.on(n.container,"mousedown touchstart",(function(e){e.preventDefault()})).on(n.container,"click",(function(){t.currentSelection=o,t.select()})),t.append(n)})),this.currentSelection=0,this.onChangeSelection()},t.prototype.selectNext=function(){this.currentSelection+1>this.elements.length-1?this.currentSelection=0:this.currentSelection+=1},t.prototype.selectPrevious=function(){0>this.currentSelection-1?this.currentSelection=this.elements.length-1:this.currentSelection-=1},t.prototype.select=function(){this.j.e.fire("select.autocomplete",this.elements[this.currentSelection].item)},(0,n.__decorate)([(0,r.watch)("currentSelection")],t.prototype,"onChangeSelection",null),(0,n.__decorate)([r.component],t)}(i.UIGroup);t.Autocomplete=u},694:function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteItem=void 0;var n=o(1);o(693);var r=o(236),i=o(131),s=function(e){function t(t,o){var n,r=e.call(this,t)||this;r.item=o;var s=r.container;if((0,i.isFunction)(o.itemRenderer)){var u=o.itemRenderer(o);(0,i.isString)(u)?s.innerHTML=u:s.appendChild(u)}else s.innerText=null!==(n=o.title)&&void 0!==n?n:o.value;return r}return(0,n.__extends)(t,e),t.prototype.className=function(){return"AutocompleteItem"},t}(r.UIElement);t.AutocompleteItem=s},693:function(e,t,o){o.r(t)}},function(e){return e(e.s=691)}])}));